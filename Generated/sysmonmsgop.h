// Copyright (c) 2021 Microsoft Corporation.

#pragma once

extern const GUID SYSMON_PROVIDER;
extern const char* SYSMON_PROVIDER_GUID;
#define SYSMON_CHANNEL 0x10

#define SYSMON_TASK_SYSMONEVENT_ERROR 0xFF
#define SYSMON_TASK_SYSMONEVENT_CREATE_PROCESS 0x01
#define SYSMON_TASK_SYSMONEVENT_FILE_TIME 0x02
#define SYSMON_TASK_SYSMONEVENT_NETWORK_CONNECT 0x03
#define SYSMON_TASK_SYSMONEVENT_SERVICE_STATE_CHANGE 0x04
#define SYSMON_TASK_SYSMONEVENT_PROCESS_TERMINATE 0x05
#define SYSMON_TASK_SYSMONEVENT_DRIVER_LOAD 0x06
#define SYSMON_TASK_SYSMONEVENT_IMAGE_LOAD 0x07
#define SYSMON_TASK_SYSMONEVENT_CREATE_REMOTE_THREAD 0x08
#define SYSMON_TASK_SYSMONEVENT_RAWACCESS_READ 0x09
#define SYSMON_TASK_SYSMONEVENT_ACCESS_PROCESS 0x0A
#define SYSMON_TASK_SYSMONEVENT_FILE_CREATE 0x0B
#define SYSMON_TASK_SYSMONEVENT_REG_KEY 0x0C
#define SYSMON_TASK_SYSMONEVENT_REG_SETVALUE 0x0D
#define SYSMON_TASK_SYSMONEVENT_REG_NAME 0x0E
#define SYSMON_TASK_SYSMONEVENT_FILE_CREATE_STREAM_HASH 0x0F
#define SYSMON_TASK_SYSMONEVENT_SERVICE_CONFIGURATION_CHANGE 0x10
#define SYSMON_TASK_SYSMONEVENT_CREATE_NAMEDPIPE 0x11
#define SYSMON_TASK_SYSMONEVENT_CONNECT_NAMEDPIPE 0x12
#define SYSMON_TASK_SYSMONEVENT_WMI_FILTER 0x13
#define SYSMON_TASK_SYSMONEVENT_WMI_CONSUMER 0x14
#define SYSMON_TASK_SYSMONEVENT_WMI_BINDING 0x15
#define SYSMON_TASK_SYSMONEVENT_DNS_QUERY 0x16
#define SYSMON_TASK_SYSMONEVENT_FILE_DELETE 0x17
#define SYSMON_TASK_SYSMONEVENT_CLIPBOARD 0x18
#define SYSMON_TASK_SYSMONEVENT_PROCESS_IMAGE_TAMPERING 0x19
#define SYSMON_TASK_SYSMONEVENT_FILE_DELETE_DETECTED 0x1A

extern const EVENT_DESCRIPTOR SYSMONEVENT_ERROR_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_CREATE_PROCESS_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_FILE_TIME_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_NETWORK_CONNECT_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_SERVICE_STATE_CHANGE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_PROCESS_TERMINATE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_DRIVER_LOAD_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_IMAGE_LOAD_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_CREATE_REMOTE_THREAD_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_RAWACCESS_READ_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_ACCESS_PROCESS_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_FILE_CREATE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_REG_KEY_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_REG_SETVALUE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_REG_NAME_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_FILE_CREATE_STREAM_HASH_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_SERVICE_CONFIGURATION_CHANGE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_CREATE_NAMEDPIPE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_CONNECT_NAMEDPIPE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_WMI_FILTER_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_WMI_CONSUMER_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_WMI_BINDING_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_DNS_QUERY_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_FILE_DELETE_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_CLIPBOARD_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_PROCESS_IMAGE_TAMPERING_EVENT;
extern const EVENT_DESCRIPTOR SYSMONEVENT_FILE_DELETE_DETECTED_EVENT;

#define SYSMONEVENT_ERROR_EVENT_value 255
#define SYSMONEVENT_CREATE_PROCESS_EVENT_value 1
#define SYSMONEVENT_FILE_TIME_EVENT_value 2
#define SYSMONEVENT_NETWORK_CONNECT_EVENT_value 3
#define SYSMONEVENT_SERVICE_STATE_CHANGE_EVENT_value 4
#define SYSMONEVENT_PROCESS_TERMINATE_EVENT_value 5
#define SYSMONEVENT_DRIVER_LOAD_EVENT_value 6
#define SYSMONEVENT_IMAGE_LOAD_EVENT_value 7
#define SYSMONEVENT_CREATE_REMOTE_THREAD_EVENT_value 8
#define SYSMONEVENT_RAWACCESS_READ_EVENT_value 9
#define SYSMONEVENT_ACCESS_PROCESS_EVENT_value 10
#define SYSMONEVENT_FILE_CREATE_EVENT_value 11
#define SYSMONEVENT_REG_KEY_EVENT_value 12
#define SYSMONEVENT_REG_SETVALUE_EVENT_value 13
#define SYSMONEVENT_REG_NAME_EVENT_value 14
#define SYSMONEVENT_FILE_CREATE_STREAM_HASH_EVENT_value 15
#define SYSMONEVENT_SERVICE_CONFIGURATION_CHANGE_EVENT_value 16
#define SYSMONEVENT_CREATE_NAMEDPIPE_EVENT_value 17
#define SYSMONEVENT_CONNECT_NAMEDPIPE_EVENT_value 18
#define SYSMONEVENT_WMI_FILTER_EVENT_value 19
#define SYSMONEVENT_WMI_CONSUMER_EVENT_value 20
#define SYSMONEVENT_WMI_BINDING_EVENT_value 21
#define SYSMONEVENT_DNS_QUERY_EVENT_value 22
#define SYSMONEVENT_FILE_DELETE_EVENT_value 23
#define SYSMONEVENT_CLIPBOARD_EVENT_value 24
#define SYSMONEVENT_PROCESS_IMAGE_TAMPERING_EVENT_value 25
#define SYSMONEVENT_FILE_DELETE_DETECTED_EVENT_value 26
#define EVENT_COUNT  27
// EVENT_COUNT_P2 is always the power of 2 equal or greater
// than the actual number of events, for easy eBPF maths
#define EVENT_COUNT_P2  32
